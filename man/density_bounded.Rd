% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/density_bounded.R
\name{density_bounded}
\alias{density_bounded}
\title{Bounded density estimator using Beta kernels}
\usage{
density_bounded(
  x,
  n = 512,
  bandwidth = "bw.nrd0",
  adjust = 1,
  trim = TRUE,
  limits = c(0, 1),
  corrected = FALSE,
  ...
)
}
\arguments{
\item{x}{Numeric vector containing a sample to compute a density estimate for.}

\item{n}{The number of equally-spaced points to use as a grid for density estimation.}

\item{bandwidth}{The bandwidth of the density estimator or a function to compute the
bandwidth. The bandwidth is expressed as the desired standard deviation of the Beta
kernel when its mean is 0.25 or 0.75 times the range of the
\code{limits}; because the bandwidth is adaptive this implies a slightly larger bandwidth
towards the center of the range and a smaller bandwidth towards the boundaries
(See \emph{Bandwidth specification} below).
This approach allows bandwidths to be specified on the scale of the original data
and for existing bandwidth estimators, such as \code{\link[=bw.nrd0]{bw.nrd0()}} or \code{\link[=bw.SJ]{bw.SJ()}}, to be used.
Can be:
\itemize{
\item a function that takes a numeric vector containing the sample and returns a bandwidth.
\item a string naming such a function.
\item a single numeric value giving the desired bandwidth.
}}

\item{adjust}{The bandwidth used is actually \code{bandwidth*adjust}. This makes it easy
to specify values like "half the default bandwidth".}

\item{trim}{Should the result be trimmed to the range of \code{x} (\code{trim = TRUE}), or extend
all the way to the range of \code{limits} (\code{trim = FALSE})?}

\item{limits}{Numeric vector of size 2 giving the boundaries of the density estimator.
Boundaries can be infinite; infinite boundaries are set at \code{3*bandwidth} beyond the
range of the input data (because \code{bandwidth} is on a standard deviation scale this
should allow the density estimator to go approximately to 0 before hitting the limit).
This allows density estimation of data with one finite limit, e.g. by setting
\code{limits = c(0, Inf)}.}

\item{corrected}{Should the bias-corrected form of Chen's (1999) estimator be used?
If \code{FALSE}, the uncorrected estimator (\eqn{\hat{f}_1}{f_1} in Chen) is used; if
\code{TRUE} the bias-corrected estimator (\eqn{\hat{f}_2}{f_2} in Chen) is used.}

\item{...}{Other arguments passed on to other methods (currently ignored).}
}
\description{
Bounded density estimator using Beta kernels, based on Chen (1999), but using
a different approach to specifying the bandwidth (see \emph{Bandwidth specification}).
Supports \link[=partial-functions]{partial function application}.
}
\section{Bounded Beta kernels}{


The kernel density estimate \eqn{\hat(f)(x)} using Beta kernels on a bounded support takes the
following general form:

\deqn{\hat{f}(x) = \frac{1}{n} \sum_{i=1}^n f_\textrm{Beta}(X_i|\alpha(x),\beta(x))}

\eqn{X_1, ..., X_n} is the sample (\code{x}) and \eqn{b} is
a bandwidth parameter derived from \code{bandwidth} (see \emph{Bandwidth specification} below).
We assume the support is [0,1]; if not, we scale from \code{limits} into [0,1].

Which estimator is used is determined by the functions \eqn{\alpha(x)} and \eqn{\beta(x)}.

For \code{corrected = FALSE} (\eqn{\hat{f}_1}{f_1} in Chen), these are:

\deqn{\alpha_1(x) = \frac{x}{b}+1}
\deqn{\beta_1(x) = \frac{1 - x}{b}+1}

For \code{corrected = TRUE} (\eqn{\hat{f}_2}{f_2} in Chen), these are:

\deqn{\alpha_2(x) = \left\{
  \begin{array}{ c l }
    \rho(x,b)   & \quad \textrm{if } x < 2b \\
    \frac{x}{b} & \quad \textrm{if } x \geq 2b
  \end{array}
\right.}
\deqn{\beta_2(x) = \left\{
  \begin{array}{ c l }
    \frac{1 - x}{b} & \quad \textrm{if } x \leq 1 - 2b\\
    \rho(1 - x,b)   & \quad \textrm{if } x > 1 - 2b
  \end{array}
\right.}

Where:

\deqn{\rho(x,b) = 2b^2 + 2.5 - \sqrt{4b^4 + 6b^2 + 2.25 - x^2 - \frac{x}{b}}}

In practice, for moderate or large samples this bias correction is small, and for some
bandwidths the correction results in a discontinuous density estimate, so
the current default is \code{corrected = FALSE}.
}

\section{Bandwidth specification}{


Unlike the \eqn{b} parameter for bandwidths defined in Chen (1999),
\code{bandwidth} is expressed as the desired standard deviation of the Beta
kernel when its mean is 0.25 or 0.75 times the range of
the \code{limits}. This is intended to allow more natural specification of
bandwidths on the scale of the original data.

Specifically, given a \code{bandwidth} expressed as a standard deviation \eqn{s},
we translate this to the bandwidth parameter \eqn{b} via:

\deqn{b = \frac{1}{\frac{3}{16}s^{-2} - 1}}{b = 1/(s^(-2) * 3/16 - 1)}

This is derived from the formula for the standard deviation of a Beta
distribution with \eqn{\alpha_1(0.25)} and \eqn{\beta_1(0.25)}.
}

\references{
Chen, Song Xi. (1999). "Beta kernel estimators for density functions".
\emph{Computational Statistics and Data Analysis} 31 (2): 131--145.
\doi{10.1016/S0167-9473(99)00010-9}.
}
